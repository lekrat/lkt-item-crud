(function(r,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("lkt-http-client")):typeof define=="function"&&define.amd?define(["exports","vue","lkt-http-client"],e):(r=typeof globalThis<"u"?globalThis:r||self,e(r.LktItemCrud={},r.Vue,r.lktHttpClient))})(this,function(r,e,u){"use strict";const h={class:"lkt-item-crud"},k={key:0,class:"lkt-item-crud_header"},_={class:"lkt-item-crud_header-title"},y={class:"lkt-item-crud_header-slot"},V={key:1,class:"lkt-item-crud_content"},C={name:"LktItemCrud",inheritAttrs:!1},S=e.defineComponent({...C,props:{modelValue:{type:Object,required:!1,default:()=>({})},readResource:{type:String,required:!0},readData:{type:Object,required:!1,default:()=>({})},createResource:{type:String,required:!1},updateResource:{type:String,required:!1},deleteResource:{type:String,required:!1},title:{type:String,default:""}},emits:["update:modelValue","read","save","perms"],setup(o,{expose:f,emit:w}){const l=o,B=e.useSlots(),c=w,a=e.ref(!0),s=e.ref(l.modelValue),m=e.ref([]),p=async()=>(a.value=!0,await u.httpCall(l.readResource,l.readData).then(t=>{a.value=!1,s.value=t.data,m.value=t.perms,c("read",t)})),R=e.computed(()=>a.value?!1:l.title||!!B["post-title"]);e.watch(()=>l.modelValue,t=>s.value=t),e.watch(s,()=>c("update:modelValue",s.value)),e.watch(m,()=>c("perms",m.value));const g=async t=>{const i=l.createResource;return a.value=!0,await u.httpCall(i,{...t}).then(d=>{a.value=!1,c("save",d)})},E=async t=>{const i=l.updateResource;return a.value=!0,await u.httpCall(i,{...t}).then(d=>{a.value=!1,c("save",d)})};return l.readResource&&p(),f({fetchItem:p,create:g,update:E,refresh:p}),(t,i)=>{const d=e.resolveComponent("lkt-loader");return e.openBlock(),e.createElementBlock("article",h,[R.value?(e.openBlock(),e.createElementBlock("header",k,[e.createElementVNode("h1",_,e.toDisplayString(o.title),1),e.createElementVNode("div",y,[e.renderSlot(t.$slots,"post-title",{item:s.value})])])):e.createCommentVNode("",!0),a.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",V,[e.renderSlot(t.$slots,"item",{item:s.value})])),a.value?(e.openBlock(),e.createBlock(d,{key:2})):e.createCommentVNode("",!0)])}}}),n={detail:0,form:1,quick:2,card:3,isValid(o){return[n.detail,n.form,n.quick,n.card].indexOf(o)!==-1}},q={install:(o,f={})=>{o.component("LktItemCrud",S)}};r.ViewMode=n,r.default=q,Object.defineProperties(r,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
